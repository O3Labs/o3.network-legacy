<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>O3</title>
    <meta name="description" content="This is Finance 2.0 â€” Interacting with the blockchain has never been this simple. O3 is a gateway that provides access to the NEO blockchain. You will be able to manage your digital assets in a simple and secure way directly from your mobile device.">

    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />
    <meta property="og:image" content="https://o3.network/img/opengraph.jpg"/>
    <link rel="apple-touch-icon" sizes="180x180" href="../img/icon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../img/icon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../img/icon/favicon-16x16.png">
    <link rel="manifest" href="../img/icon/manifest.json">
    <link rel="mask-icon" href="../img/icon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="theme-color" content="#ffffff">


    <link href="../css/bootstrap.min.css" rel="stylesheet" />
    <link href='../css/fonts.css' rel='stylesheet' type='text/css'>
    <link href="../css/paper-kit.css?v=2.1.0" rel="stylesheet"/>
    <link href="../css/nucleo-icons.css" rel="stylesheet">

    <script src="js/vue.min.js"></script>
    <style type="text/css">
    .card img{
        border-radius: 0;
    }
</style>
</head>
<body >
    <nav class="navbar navbar-expand-lg fixed-top" color-on-scroll="300">
        <div class="container">
         <a class="navbar-brand" href="/">O<sub><small>3</small></sub></a>

         <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
            <span class="navbar-toggler-icon"></span>
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse " id="navbarNavDropdown">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="mailto:hello@o3.network">Contact</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="wrapper mt-4" id="app">
    <div class="section">
        <div class="container">
           <div class="row">
            <div class="col-md-12"> <h3>NEP9 QR Code Generator</h3></div>
        </div>
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="form-group">
                    <h6>NEO Address <span class="icon-danger">*</span></h6>
                    <input type="text" class="form-control border-input" placeholder="enter valid NEO Address here." v-model="nep9.address">
                </div>
                <div class="form-group">
                    <h6>ASSET <span class="icon-danger">*</span></h6>

                    <ul class="nav nav-pills nav-pills-info">
                       <li class="nav-item">
                           <a class="nav-link active" data-toggle="pill" href="" role="tab" v-on:click="selectAsset('neo')">NEO</a>
                       </li>

                       <li class="nav-item">
                           <a class="nav-link" data-toggle="pill" href="" role="tab" v-on:click="selectAsset('gas')">GAS</a>
                       </li>
                   </ul>
               </div>
               <div class="form-group">
                <h6>Amount</h6>
                <input type="number" min="0.1" class="form-control border-input" v-model="nep9.query.amount"/>
            </div>
            <div class="form-group">
                <h6>Description</h6>
                <textarea class="form-control textarea-limited" placeholder="Description" rows="3" maxlength="50" v-model="nep9.query.description"></textarea>
                <h5><small><span id="textarea-limited-message" class="pull-right" >50 characters left</span></small></h5>
            </div>
            <button class="btn btn-outline-primary btn-block btn-round" v-on:click="constructURI()">Generate</button>
        </div>
        <div class="col-md-4 my-auto" >
           <div class="card no-transition">
             <div class="card-body">
                 <h6 class="card-category">NEP9 Compatible QR Code</h6>
                 <canvas  class="my-4" id="qr-canvas" width="200" height="200"></canvas>
                 <div id="qrcode" style="display: none;"></div>
                 <p class="card-description">{{generatedURI}}</p>
             </div>
         </div>


     </div>
 </div>
</div>
</div>
</div>

</body>

<script src="js/qrcode.min.js" type="text/javascript"></script>
<script type="text/javascript">
    CanvasRenderingContext2D.prototype.roundRect = function (x, y, w, h, r) {
  if (w < 2 * r) r = w / 2;
  if (h < 2 * r) r = h / 2;
  this.beginPath();
  this.moveTo(x+r, y);
  this.arcTo(x+w, y,   x+w, y+h, r);
  this.arcTo(x+w, y+h, x,   y+h, r);
  this.arcTo(x,   y+h, x,   y,   r);
  this.arcTo(x,   y,   x+w, y,   r);
  this.closePath();
  return this;
}
 var app = new Vue({
  el: '#app',
  data: {
    gasID:"602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7",
    neoID:"c56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b",
    generatedURI:"",
    nep9:{
        scheme:"neo",
        address:"AKcm7eABuW1Pjb5HsTwiq7iARSatim9tQ6",
        query:{
            assetID:"c56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b",
            amount:0.0,
            description:null,
        }
    },
},
watch: {
        nep9: {
            handler(val){
                this.constructURI();    
            },
            deep:true,
        }
    },
    methods: {
        drawLogo() {
            var canvas = document.getElementById('qr-canvas'),
            context = canvas.getContext('2d')
            var qrImage = document.getElementById('qrcode').querySelector("img");
            var img = new Image();
            img.onload = function() {
                context.drawImage(qrImage,0,0);
                context.roundRect(70, 70, 60, 60,5);
                context.fillStyle = 'white';
                context.fill();
                context.drawImage(img, 80, 80,40,40);
            }
            img.src = "img/neo.svg";
        },
        generateQR(text) {
            var qrSpan = document.getElementById("qrcode");
            qrSpan.innerHTML ="";
            var qrcode = new QRCode("qrcode", {
                text: text,
                width: 200,
                height: 200,
                colorDark : "#000000",
                colorLight : "#ffffff",
                correctLevel : QRCode.CorrectLevel.H
            }); 

            this.drawLogo();
        },
        constructURI(){
            var queryKeys = Object.keys(this.nep9.query)
            var queryValues = Object.values(this.nep9.query)
            var query = [];
            for (var i in queryKeys) {
                var key = queryKeys[i];
                var value = queryValues[i];
                if (value != null) {
                    query.push(key + "=" + encodeURIComponent(value))
                }
            }
            this.generatedURI = this.nep9.scheme +":" + this.nep9.address + "?" + query.join("&");
            this.generateQR(this.generatedURI);
        },
        selectAsset(v) {
            if (v=="neo") {
                this.nep9.query.assetID = this.neoID;
            }else {
                this.nep9.query.assetID = this.gasID;
            }
            this.constructURI();
        }
    },
    mounted() {
        this.constructURI();
    }
})

</script>
<!-- Core JS Files -->
<script src="../js/jquery-3.2.1.min.js" type="text/javascript"></script>
<script src="../js/jquery-ui-1.12.1.custom.min.js" type="text/javascript"></script>
<script src="../js/popper.js" type="text/javascript"></script>
<script src="../js/bootstrap.min.js" type="text/javascript"></script>
<script src="../js/paper-kit.js?v=2.1.0"></script>
</html>